# 天凤牌谱爬虫工具

这是一个用于爬取[天凤麻将](https://tenhou.net/)牌谱数据的Python爬虫工具。通过此工具，您可以批量爬取玩家的牌谱记录并保存为CSV格式，方便后续分析。

## 功能特点

- 支持从排行榜批量爬取多个用户的牌谱数据
- 支持单独爬取指定用户的牌谱记录
- 自动保存爬取进度，支持断点续爬
- 自动处理网页弹窗和提示框
- 将牌谱数据保存为CSV格式，便于后续分析处理

## 环境要求

- Python 3.6+
- DrissionPage
- 其他依赖库: requests, lxml, datetime, csv, pickle

## 安装指南

1. 克隆本仓库到本地：

```bash
git clone https://github.com/your-username/tenhou-crawler.git
cd tenhou-crawler
```

2. 安装所需依赖：

```bash
pip install drissionpage requests lxml
```

## 使用方法

### 运行爬虫

直接运行`basic.py`脚本：

```bash
python basic.py
```

程序会提示您选择操作模式：

1. **从排行榜页面爬取多个用户**：批量爬取排行榜上的玩家牌谱
2. **爬取单个用户数据**：只爬取指定用户的牌谱
3. **退出**：退出程序

### 选项1: 批量爬取

选择选项1后，您可以：
- 输入自定义排行榜URL
- 直接回车使用默认URL: `https://nodocchi.moe/tenhoulog/graderank.html#!&playernum=4&orderby=0&rg=0`

程序会自动从排行榜页面获取玩家列表，然后依次爬取每位玩家的牌谱数据。

### 选项2: 爬取单个用户

选择选项2后，输入要爬取的用户名，程序会专门爬取该用户的牌谱数据。

### 断点续爬

程序会在`progress`目录下保存爬取进度。如果爬取过程中断，再次运行时会询问是否继续上次的进度。

## 目录结构

爬虫运行后会创建以下目录：

- `csv_files/`: 存放爬取的牌谱数据（CSV格式）
- `progress/`: 存放爬取进度记录

## 数据格式

爬取的CSV文件包含以下字段：

- `顺位`: 玩家在该局游戏中的排名
- `用时`: 该局游戏用时（分钟）
- `开始时间`: 游戏开始时间
- `牌普`: 牌谱URL
- `一号玩家`/`二号玩家`/`三号玩家`/`四号玩家`: 四位玩家昵称
- `一位得点`/`二位得点`/`三位得点`/`四位得点`: 四位玩家得分

项目上传的有示例项目，可以先浏览
## 注意事项

- 爬取速度设置了间隔，以避免对目标网站造成过大压力
- 首次运行时，程序会下载并安装Chrome驱动（由DrissionPage自动完成）
- 爬取过程中请勿关闭自动弹出的浏览器窗口

## 许可

本项目采用MIT许可证 
